---
title: 'Multi Constraint Pricing for Arbitrum chains'
sidebar_label: 'Multi Constraint Pricing for Arbitrum chains'
description: 'Guidance & best practices for using Multi Constraint Pricing on Arbitrum chains'
content_type: release announcement
author: asomani
sme: asomani
---

## tldr; (ArbOS 51\)

Arbitrum chains are going to be using a new multi-constraint pricing system as part of the ArbOS 51 upgrade to reduce the frequency and severity of child chain gas price spikes.

- **Key Action:** We recommend waiting for 30 days before enabling the new constraints for your own chain.

  This change is **backward compatible**. Setting new gas pricing constraints is **not mandatory**; if no new configuration is set, the legacy gas pricing algorithm remains active.

:::note

The upgrade to ArbOS 51 is independent of setting of these new gas targets. The new constraints are completely opt-in, so you can choose when to enable them.

:::

- **The Change:** The algorithm uses multiple time windows and multiple gas targets to balance traffic spikes with overall fee stability.  
- **Additional Details:** For those interested in how these values are derived, this document provides the underlying parameters used to calculate optimized constraints.

## Purpose

The improvement aims to reduce the severity, frequency, and duration of high L2 gas prices during periods when demand exceeds the gas target. Detailed information on the upgrade can be found [here](https://forum.arbitrum.foundation/t/aip-raise-the-gas-target-min-l2-base-fee-implement-improvements-to-the-pricing-algorithm/30182). 

What does this NOT fix/help? 

- L1 gas fee spikes on Ethereum   
- Data availability  Pricing 

## How to set the constraints

You can call SetGasPricingConstraints on the ArbOwner precompile with an array of constraints, where each constraint contains \[gasTargetPerSecond, adjustmentWindowSeconds, startingBacklogValue\].

```ts
// Example: Set short-term and long-term constraints  
// Define constraints: [gasTargetPerSecond, adjustmentWindowSeconds, startingBacklogValue] 
const shortTerm = [30_000_000, 1, 800_000]; // Reacts to immediate spikes [cite: 10, 18] 
const longTerm = [15_000_000, 600, 1_600_000]; // Ensures price stability [cite: 13, 18] 
// Call ArbOwner precompile to set the constraints
await arbOwner.setGasPricingConstraints([shortTerm, longTerm]);
```

Each constraint consists of three parameters \-

1. gasTargetPerSecond \- the desired gas processing rate for your Arbitrum chain \- it's the amount of gas the system aims to process each second under normal conditions. Any demand above this target will induce a gas price increase as a way to economically disincentivize usage until it gets reduced to the target.   
2. adjustmentWindowSeconds \- Determines the time period over which gas usage is averaged to calculate fee adjustments; a larger window results in more stable, predictable pricing, while a smaller window reacts aggressively to traffic spikes.  
3. startingBacklogValue \- the initial gas backlog debt when the constraint is created that forces the chain to start with a higher base fee, preventing bots from spamming the network with near-zero cost transactions during the initial launch phase.

## How to find the right values for the constraints

We have developed a [script](https://colab.research.google.com/drive/1D28YghOmCjvvrLWS5FsTp5xNKz9JHAA3?usp=sharing) which takes in certain parameters to find the most optimized pricing constraints. The script takes in below params \-

1. long\_term\_gas\_target \- Desired long term average gas throughput for the chain  
2. node\_throughput \- Sustainable maximum throughput that the nodes can maintain without any issues  
3. gas\_limit \- Theoretical max block size limit  
4. max\_rate\_of\_increase\_percent\_per\_second \- maximum allowed rate of increase in the fee per sec when chain is working at the max capacity   
5. long\_term\_adjustment\_window\_seconds \- the longest window for rate change

Below values were used for calculating the constraints for Arbitrum One. These values have been calculated based on various UX and research considerations.

| Param | Arbitrum One Config |
| :---- | :---- |
| long\_term\_gas\_target | 10 Mgas/s |
| node\_throughput | 80 Mgas/s |
| gas\_limit | 192 Mgas/s |
| max\_rate\_of\_increase\_percent\_per\_second | 20 |
| long\_term\_adjustment\_window\_seconds | 86400 sec |

## Recommendation for Arbitrum chains

The launch of the constraint-based pricing will be done on Arbitrum One. We recommend waiting for the constraints to be configured and optimized on Arbitrum One, with a default grace period of 30 days before upgrading your chain to ArbOS 51\. Post which the Arbitrum chain teams can adopt the same values as set on Arbitrum One.

| Param | Arbitrum One Config | Recommendation |
| :---- | :---- | :---- |
| long\_term\_gas\_target | 10 Mgas/s | Configure based on resource management considerations. Conservative \- same as Arbitrum One Aggressive \- 20 Mgas /s |
| node\_throughput | 80 Mgas/s | Same as Arbitrum One |
| gas\_limit | 192 Mgas/s | Based on the block limit for the chain.Can be set to (MaxBlockGasLimit \+ MaxEffectiveGasLimit) / 2 |
| max\_rate\_of\_increase\_percent\_per\_second | 20 | Same as Arbitrum One |
| long\_term\_adjustment\_window\_seconds | 86400 sec | Same as Arbitrum One |

