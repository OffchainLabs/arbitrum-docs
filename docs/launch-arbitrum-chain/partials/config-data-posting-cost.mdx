## Data Posting Costs

This guide breaks down the key aspects of data posting costs in Arbitrum chains (including Orbit L2s and L3s) to help you make informed decisions about cost, security, and user experience. Data posting costs arise when submitting transaction batches to a parent chain (e.g., Ethereum or Arbitrum L2) for data availability, which ensures security and verifiability. Below, we explain the core components, decisions, and trade-offs in a concise, business-friendly format.

### Key Cost Components

1. **Parent Chain Base Fee**: Covers the cost of posting compressed transaction data to the parent chain.

- Determined by transaction size and the parent chain’s current fee.
- Automatically adjusts based on batch poster reports, but can be manually set.
- For chains using custom `ERC-20` tokens, turn off to avoid incorrect charges.

2. **Parent Chain Surplus Fee**: Optional fee to reward batch posters.

- Set as a rate on top of the base fee; proceeds go to a designated recipient.
- Higher rates incentivize batch posters but increase user costs.

3. **Compression**: Uses Brotli to reduce data size and lower costs.

- Compression adjusts dynamically based on transaction backlog.
- Higher compression saves costs but requires more computing power.

4. **Adaptive Pricing**: Balances fees collected with actual costs.

- Tracks surpluses/deficits to adjust pricing dynamically.
- Ensures batch posters receive reimbursement without overcharging users.

5. **Fee Collection**: Fees are divided based on estimated transaction sizes.

- Batch posters receive base fees, while surplus fees are allocated to a designated recipient.
- Additional costs include infrastructure (e.g., ~$600/month per sequencer) and validator bonds (e.g., ~3600 `ETH` equivalent).

6. **Data Availability (DA) Options**:

- **Rollup**: Posts all data to Ethereum for maximum security but higher costs.
- **AnyTrust**: utilizes a Data Availability Committee (DAC) for cost-effective offchain storage with an onchain fallback.
- **Celestia**: Leverages modular DA for potentially lower costs but relies on external systems.

### Key Decisions and Trade-Offs

The following table summarizes critical decisions to optimize costs, security, and user experience. These are set at chain deployment or adjusted post-launch via governance.

| Decision Area                | Key Questions                                                     | Trade-Offs                                                                                                                                                           |
| ---------------------------- | ----------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **DA Solution**              | Should you use Rollup, AnyTrust, or Celestia?                     | **Rollup**: Most secure, highest cost. **AnyTrust**: Cheapest, flexible, but relies on DAC trust. **Celestia**: Scalable, low-cost, but depends on external systems. |
| **Base Fee**                 | How should base fees be set?                                      | Accurate estimates prevent losses but overestimating raises user fees. Disable for custom tokens to avoid errors.                                                    |
| **Surplus Fee**              | How much reward for batch posters?                                | Higher rewards attract posters but increase user costs. Low rewards may reduce poster participation.                                                                 |
| **Batch Posters**            | How many posters and who collects fees?                           | More posters increase decentralization but add complexity. Fee distribution impacts incentives.                                                                      |
| **Compression**              | What compression level suits your chain?                          | Higher compression lowers costs but requires more compute. Larger batches reduce frequency but may delay transactions.                                               |
| **Challenge Period & Stake** | How long is the challenge period, and what’s the validator stake? | Longer periods and higher stakes enhance security but increase costs and delay finality.                                                                             |
| **Gas Token**                | Use `ETH` or a custom `ERC-20` token?                             | Custom tokens add flexibility but require funding for DA. Low minimum fees reduce barriers but risk denial-of-service attacks.                                       |

### Recommendations

- Test first: Use the Sepolia testnet to experiment with configurations before deployment.
- Balance Cost and Security: For high-throughput chains, optimize compression and stakes. For general use, default settings are often sufficient.
- **Consider user experience**: High fees or delays can deter users, so prioritize cost-efficient DA options like AnyTrust or Celestia if security needs allow.
- **Consult experts**: For non-standard setups, work with Offchain Labs to minimize risks like DoS attacks.

### Tools for Cost Estimation

- Use `NodeInterface.gasEstimateComponents()` or `NodeInterface.gasEstimateL1Component()` to preview costs.
- Check transaction receipts for `gasUsedForL1` to understand actual costs.

By carefully configuring these elements, you can achieve cost efficiency while maintaining security and a seamless user experience.
